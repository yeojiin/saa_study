### 프라이빗 vs 퍼블릭 vs 탄력적 IP
- IPV4: .을 기준으로 4개의 . 이 존재
- 공용 IP가 있으면 인터넷 전역에 액세스 가능, 사설 IP는 사설 네티워크 내에서만 액세스 가능
- 사설IP에 인터넷 게이트웨이(public)이 붙으면 인터넷 전역과 통신이 가능해짐
- public IP
	- 기기가 인터넷 상에서 식별될 수 있음
- private IP
	- 사설 네트워크 안에서만 식별되기 때문에 **사설 네트워크 안에서만 유일**하면 됨 -> 다른 네트워크에서는 중복될 수 있음
	- www로 연결하고 싶으면 NAT + internet GW (proxy 역할)
		- proxy는 클라이언트와 서버 사이에 존재하며, `중계기`로 대리로 통신을 수행하는 것
	- 지정된 범위 내에서 IP가 생성됨
	- VPN을 사용해 사설 네트워크망에 접속하면 접근 가능
- elastic IP
	- 인스턴스가 재실행될 때마다 공용 IP가 새롭게 할당될 수 있음 ->고정된 공용 IP를 사용하면 엘라스틱 IP가 필요함
	- 계정 당 5개의 elastic IP를 사용하고 그 이상 필요하면 AWS에 문의
	- Elastic IP사용은 비권장 -> 임의의 공용 IP를 사용해 DNS 이름을 할당하는 것이 좋음(도메인), 로드밸런서를 사용해 공용 IP를 사용하지 않을 수도 있음
### 배치 그룹(placement groups)
- EC2 인스턴스가 AWS 인프라에 배치되는 방식을 제어할 때 사용
- 배치그룹을 사용해 전략을 짤 수 있음
- 3가지 전략
	- 클러스터(cluster) 배치 그룹
		- 단일 가용 영역 내에서 지연 시간이 짧은 하드웨어 설정 - cluster instances into a low latency group in a single Availability Zone
		- 하이 퍼포먼스 하이 리스크
		- 모든 인스턴스가 같은 랙 즉, 같은 하드웨어, 같은 가용 영역 안에 존재
		- 지연 속도가 빠르지만 하드웨어가 실패하면 모든 EC2가 전체 실패됨
		- 빅데이터 작업에 유리
	- 분산(spread) 배치 그룹
		- 인스턴스가 다른 하드웨어에 분산됨 - spreads instances across underlying hardware
		- <u>최대 7개의 인스턴스가 각 AZ마다</u>
		- critical application이 있는 경우 사용
		- 실패 위험 최소화 인스턴스가 그룹별로 다른 하드웨어에 존재
		- 여러 가용 영역에 있어 실패 확률이 적음 -> 서버 이중화처럼
	- 분할(partition) 배치 그룹:  여러 파티션에 인스턴스가 분할
		- 파티션은 가용 영역 내의 다양한 하드웨어 랙 세트에 의존 - spreads instances across many different partition
		- 인스턴스가 분산되어 있지만 다른 실패로부터 격리되지 않음, 하지만 파티션은 다른 오류 파티션과 격리되어야 함
		- 하둡, 카산드라, 카프카 등에 사용 가능
		- us-east-1a, us-east-1b로 가용영역이 나뉘고,  그 안에서 파티션이 나눔 그 안에 여러 인스턴스가 존재할 수 있음 
		- 파티션 = aws 랙
		- 랙 실패로 부터 안전하고, 동일한 리전의 여러 가용 영역에 걸쳐 있을 수 있음
		- 파티션의 갯수 제한은 있지만 인스턴스는 파티션 안에 마음대로 설정할 수 있으므로 <u>인스턴스 수량을 많이 늘릴 수 있는 점이 분산 배치 그룹과 차이</u>
			- us-east-1a에 파티션 2개를 두고 각각 4개의 인스턴스를 띄우고, us-east-1b에 파티션 1개를 두고 안에 4개의 인스턴스를 띄우는 것 같음
			- 분산은 us-east-1a, us-east-1b, us-east-1c 각각 인스턴스 띄움
		- HDFS, HBase, 카산드라, 카프카 등에 사용
### ENI(Elastic network interface)
- VPC의 논리적 구성 요소이며 가상 네트워크 카드를 의미함
- **EC2인스턴스가 네트워크에 액세스 할 수 있게 해줌**
- 인스턴스 외부에서도 사용 가능
- 속성
	- 주요 private IPv4과 하나 이상의 secondary IPv4를 가질 수 있음
	- 하나의 엘라스틱 아이피 당 하나의 사설 IPv4 및 공용 IP가 한 개씩 제공
	- 하나 이상의 보안 그룹을 연결할 수 있음
	- EC2인스턴스와 독립적으로 ENI를 생성하고 즉시 연결하거나 장애 조치를 위해 EC2인스턴스에서 이동시킬 수 있음
		- EC2 1에 Eth0과 Eth1이 연결되고, EC2 2에 Eth0이 연결되어 있을 때
		- 1번이 장애가 생기면 2에 Eth1을 옮겨서 사설 IP가 1인스턴스에서 2인스턴스로 연결되게 할 수 있음 -> 장애조치에 유용
	- 특정 가용 영역인 AZ에 바인딩됨
### EC2 하이버네이트(절전모드)
- 인스턴스 stop: EBS 디스크 데이터는 다시 시작할 때까지 유지
- 인스턴스 terminate: 루트 볼륨이 삭제되는 설정을 활성화 했다면 인스턴스도 삭제되지만 나머지는 남음
	- DeleteOnTermination 설정은 루트 볼륨은 True, 나머지 볼륨 유형은 False로 보통 설정
	- 보통 EC2가 종료되면 해당 EC2와 여결된 루트 볼륨이 삭제됨 
- restart: 운영 체제가  재실행-> 사용자 데이터 실행 -> 운영 체제 시작 -> 애플리케이션 시작
- 절전모드(하이버네이트)에 들어가면 RAM에 기록된 인 메모리 상태는 보존됨 -> 부팅이 빨라짐 -> 루트 경로의 EBS 볼륨에 기록되기 때문에, 그래서 EBS 볼륨 암호화가 필요하고 볼륨 용량도 RAM을 저장하기 충분해야 함
- 인스턴스를 종료하면 RAM은 사라지지만 EBS 볼륨에 RAM이 덤프된 게 남아있어서 재실행 시 디스크에서 RAM을 불러와 EC2인스턴스 메모리로 가져감
	- 나중에 동일한 시점에서 인스턴스를 다시 시작할 수 있도록 인스턴스의 인메모리 상태와 private 및 EIP 주소 등을 `루트 EBS 볼륨에 있는 파일에 저장`된 다음 실질적으로 인스턴스가 종료됨
- 오래 사용되는 인스턴스를 빠르게 재시작하고 싶거나 할 때 사용
- 서비스 중지가 일어나지 않는 것처럼 보임
- 절전모드 상태에 있는 동안에는 EBS 볼륨과 EIP에 대한 요금만 지불하면 됨
- 루트 볼륨 EBS 에서만 사용 가능
- 절전 모드는 최대 60일까지 사용 가능
- RAM은 150G미만이어야 함
- EBS는 USB처럼 A인스턴스에 붙여서 사용하다가 B인스턴스에 붙여서 사용할 수 있음
	- 가상 USB 같은 것
