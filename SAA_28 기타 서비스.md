### CloudFormation - 소개
- CloudFormation은 리소스에 대해 인프라의 윤곽을 구분짓는 선언적 방법, 거의 대부분의 리소스가 지원됨
- 모든 `인프라가 코드`라는 것이 장점
	- 수동으로 리소스를 만들 필요가 없어 컨트롤이 편함
- AWS 클라우드의 작동 방식을 변경할 때마다 코드 리뷰를 통해 검토
	- 클라우드에서 작업하기 매우 좋은 방법
	- 비용적인 면에서 이익인 이유는 스택 내의 각 리소스는 스택 내에서 만들어진 다른 리소스들과 비슷하게 태그되기 때문
	- CloudFormation 템플릿을 사용하여 리소스 비용을 쉽게 예측할 수도 있음
	- 마지막으로 CloudFormation으로 `절약 전략`을 세울 수도 있음
	- 예를 들어 어떤 환경에서 오후 5시에 자동으로 모든 템플릿을 삭제하도록 할 수 있음
		- 템플릿과 연결된 모든 리소스를 삭제한 다음, 오전 9시 또는 안전하게 오전 8시에 다시 생성하도록 하는 것
		- 오후 5시와 오전 8시 사이에는 리소스가 없기 때문에 비용을 절감할 수 있음
	- CloudFormation을 통해 리소스를 쉽게 만들 수 있음
- 생산성이 높음
- 선언적 프로그래밍도 가능
	- EC2 인스턴스에서 Dynamo DB 테이블을 먼저 만들어야 하는지, 한 번에 같이 해야 하는지 알 필요가 없음
	- CloudFormation을 사용하면, 하나하나 다 만들지 않아도 됨
- 웹에 존재하는 기존 템플릿을 활용할 수 있음
- CloudFormation은 AWS에서 코드형 인프라의 기반
- CloudFormation을 시각적으로 볼 수 있어, 만들어진 걸 다이어그램으로 볼 수 있음
###  Amazon SES
- 단순 이메일 서비스
	- 이메일을 전 세계로 대규모로 안전하게 보낼 수 있는 서비스
- 완전 관리형 서비스
- 즉, 애플리케이션이 SES API 또는 SMTP 서버를 사용하면 Amazon SES가 사용자들에게 대량으로 이메일을 보냄
- 아웃바운드뿐 아니라 인바운드 이메일도 허용하기 때문에 답장을 주고받을 수 있음
- 이메일을 열었는지 여부를 알려주는 평판 대시보드와 성과 인사이트, 스팸 방지 피드백을 제공
- 이메일 전송에 대한 최신 보안 기준을 지원
	- DKIM과 SPF 기능
- 배포도 유연하게 됨
	- 공유 IP, 전용 IP, 또는 여러분의 고객 소유 IP들이 있음
	- 특정 IP 주소에서 이메일을 보내는 것
- API는 콘솔에서 액세스 가능
	- 특정 AWS API 또는 SMTP 프로토콜에서
- Amazon SES의 사용 사례는 이메일 트랜잭션 마케팅 이메일 대량 이메일 커뮤니케이션을 들 수 있음
### Amazon Pinpoint
- Amazon Pinpoint는 확장 가능한 양방향 인바운드 및 아웃바운드 마케팅 커뮤니케이션 서비스
	- Pinpoint를 통해 이메일, SMS, 푸시 알림, 음성, 인앱 메시지를 보냄
- SMS
	- Amazon Pinpoint를 통해 고객에게 SMS를 보낼 수 있음
	- 고객에게 적합한 콘텐츠로 메시지를 세분화하고 개인화 해 그룹이나 세그먼트 등을 만들 수 있음
- Pinpoint의 사용 사례는 마케팅 이메일을 대량으로 보내거나 트랜잭션 SMS 메시지를 전송하여 캠페인을 실행하는 것
- 누군가 응답하거나 성공하면 TEXT_SUCCESS, TEXT_DELIVERED, REPLIED와 같은 모든 이벤트가 Amazon SNS, Kinesis Data Firehose, CloudWatch Logs로 전달
	- Amazon Pinpoint로 모든 종류의 자동화를 쉽게 구축할 수 있음
- Pinpoint와 Amazon SNS나 Amazon SES의 차이점?
- SNS 또는 SES에서는 여러분이 각 메시지의 대상, 내용, 전달 일정을 관리해야 함
	- 애플리케이션이 해야 하는 일이죠, 많은 작업이 필요하며 확장이 되지 않을 수도 있음
- Amazon Pinpoint에서는 여러분이 직접 메시지 템플릿, 전달 일정 , 대상 세그먼트, 전체 캠페인 등을 만들지 않고 Pinpoint 서비스로 관리할 수 있음
- 완전한 마케팅 커뮤니케이션 서비스를 하고 싶다면, SAS 및 SES의 차세대 제품인 Pinpoint가 적합
### SSM Session Manager
- 사례 분석에서는 시스템 관리자의 SSM 세션 관리자 기능으로 EC2 인스턴스와 온프레미스 서버에서 보안 셸을 시작할 수 있음
	- SSH 액세스, 배스천 호스트, SSH 키가 필요 없음
	-  EC2 인스턴스의 포트 22가 닫힘
	- EC2 인스턴스에 보안 셸을 설정하기 위해 SSH를 실행할 필요가 없기 때문
	- 보안이 더 나음
- EC2 인스턴스에는 SSM 에이전트가 있고, 그 에이전트는 세션 관리자 서비스에 연결
- 사용자는 세션 관리자 서비스를 통해 EC2 인스턴스에 액세스할 수 있고 명령 실행 가능
	- Linux, MacOS, Windows를 지원하며, 로그 데이터를 Amazon S3 또는  CloudWatch Logs로 보낼 수 있습니다, 매우 안전
- EC2 인스턴스를 시작해야 함
- 인스턴스를 시작하고 키 페어는 사용하지 않음, SSH 트래픽을 비활성화하면 EC2 인스턴스는 아무것도 허용하지 않는 보안 그룹을 갖게 됨
- HTTP, HTTPS, SSH가 허용되지 않지만, SSM 세션 관리자를 셸로 사용할 수 있음
- IAM 인스턴스 프로필을 내 인스턴스에 결합시켜 그것이 SSM 서비스와 대화할 수 있도록 하는 것
- Create new IAM profile에서  SSM로 필터링해AmazonSSMManagedInstanceCore를 선택  후DemoEC2RoleForSSM이라고 할게요, 이렇게 하면 EC2가 이 정책을 사용하여 SSM 서비스 사용 가능
- Fleet Manager에는 SSM에 등록된 모든 EC2 인스턴스가 표시
- 관리 노드라
- SSM 에이전트가 온라인 상태, 플랫폼, 운영 체제 Amazon Linux 2 SSM 에이전트 버전, 그리고 EC2 인스턴스로 연결되는 링크도 있음
- 인스턴스가 Fleet Manager에 나타나면, 이에 대한 보안 셸을 실행할 준비가 됐다는 뜻
- 세션 관리자는 Linux 인스턴스와 Windows 인스턴스에 액세스하는 방법
- 보안 그룹 아래에 제 EC2 인스턴스가 있고,  인바운드 규칙이 없음
- 보안 셸이 있음
- SSH 액세스가 필요하지 않음, ping google.com을 하면 당연히 잘 작동
- 호스트 이름을 알기 위해 hostname을 하면 ip는 172.31.1.148인데 Networking으로 가서 제 인스턴스의 개인 IP 주소를 보면 정확히 일치
- SSM 보안 셸을 사용하면 AWS에서 직접 보안 셸을 사용할 수 있음
- SSH 보안 키나 SSH 액세스가 없이
- EC2 인스턴스에 액세스하는 데는 세 가지 방법
	- 포트 22를 연 다음 SSH 키와 터미널을 사용하여 SSH 명령을 수행하는 것
	- EC2 Instance Connect를 사용하는 것
		- 필요한 경우엔 Amazon EC2에 일시적으로 업로드 되기 때문에 SSH 키는 필요 없음
		- EC2 Instance Connect를 사용하여 EC2 인스턴스에 액세스하려면 여전히 포트 22를 열어야 함
	- 세션 관리자
	- Amazon EC2에 인스턴스가 있는지 확인하고, 이 EC2 인스턴스가 IAM 역할이 있는지 반드시 확인하고 IAM 역할은 Security에서 확인 가능
	- IAM 역할은 EC2 인스턴스에서 세션 관리자로 액세스를 허용하여 이를 통해 보안 셸을 실행할 수 있음
- 세션 기록이 로그로 저장
### SSM 기타 서비스
- 명령을 실행
	- 문서를 실행하는데 사용되고 스크립트 또는 명령이 한개 있고 이 명령들은 리소스 그룹을 사용하는 여러 인스턴스에서 실행됨
	- 시스템 관리자 서비스에 등록된 EC2 인스턴스 또는 온프레미스 서버들에서
		- 왜냐하면 에이전트가 거기서 실행되고 있으니까
	- 따라서 이 명령들을 실행할 때는 SSH가 필요하지 않음
	- 세션 관리자에서 본 것과 같은 메커니즘을 사용 -> 에이전트를 통해 실행됨
	- 실행 명령으로 실행된 명령의 결과는 모두 S3 또는 CloudWatch 로그로 보내짐
	- 실패가 일어나면 SNS로 전송됨
	- 따라서 진행 중, 성공, 실패 등 이런 모든 업데이트를 SNS로 보낼 수 있음
	- 보안을 위해 IAM과 완벽하게 통합
	- CloudTrail에서 누가 어떤 명령을 실행하는지 확인할 수 있음
	- EventBridge로 실행 명령을 직접 실행할 수도 있음
	- 세션 관리자의 명령 실행 기능을 사용해서 EC2 인스턴스 또는 온프레미스 서버가 있고, SSM 에이전트로 관리를 통해 매우 간단히 명령을 실행할 수 있음
	- 출력 결과는 Amazon S3 또는 CloudWatch 로그로 전송할 수 있음
	- 모든 상태 알림은 Amazon SNS로 전송
	- 사용자인 우리가 트리거하거나 EventBridge로 자동으로 트리거할 수도 있음
- 패치 관리자(Patch manager)
	- 인스턴스 관리 과정 패칭을 자동화하는 데 사용
	- 즉, 운영 체제 및 애플리케이션 업데이트 그리고 보안 업데이트를 적용하는 데 사용
	- 물론 EC2 인스턴스와 온프레미스 서버도 지원
	- Linux, Mac, Windows를 지원
	- 즉시 패치하거나 유지 관리 기간이라는 것을 사용하여 패치 일정을 잡을 수도 있음
	- 인스턴스를 패치할 준비를 하는 곳
	- 패치 관리자 내에서도 인스턴스를 스캔하여 패치 규정 준수 보고서를 생성할 수 있음
	- 모든 인스턴스가 올바르게 패치되었는지 확인하고 패치가 누락된 사람이나 경우가 있는지 찾을 수 있음
		- 즉, 콘솔이나 SDK 또는 유지 관리 기간에서 패치 관리자를 호출할 수 있음
	- `AWS-RunBatchBaseline 실행 명령`
	- 모든 EC2 인스턴스를 패치
	- 패치 관리자 내에서 보고서를 찾을 수 있음
	- 유지 관리 기간
		- 인스턴스에서 작업을 수행할 일정을 정의하는 데 사용
		- 예를 들어 OS 패치, 드라이버 업데이트 및 소프트웨어 설치 또는 원하는 작업을 수행하기 위해 유지 관리 기간을 정의할 수 있음
		- 유지 관리 기간을 정의할 때는 일정을 넣어야 함
		- 어느 인스턴스에 이 유지 관리 기간을 적용할지
		- 유지 관리 기간 동안 실행될 작업을 정해야 함
			- 24시간마다 트리거하는 등
			- 명령 실행이든 EC2 인스턴스 업데이트든 패치 작업이든 간에요 자유롭게 설정하면 됨
	- 자동화
		- 자동화는 EC2 인스턴스 또는 기타 AWS 리소스에서의 명령 유지 관리 및 배포 작업을 단순화하는 데 사용
		- 예를 들어, 자동화를 사용하면 인스턴스들을 한 번에 다시 시작할 수 있음
			- AMI를 생성하거나 EBS 스냅샷을 생성하는 등의 작업을 할 수 있음
		- 자동화(Automation) 런북도 있음
		- EC2 인스턴스 또는 AWS 리소스에 동일한 문서로 표시된 미리 정의된 작업
		- 런북은 SSM 자동화에서 사용
		- EC2 인스턴스에서 특정 작업을 실행
			- 예를 들어, 전부 재시작 등의 작업
		- 또는 AWS 리소스에서 작업을 실행할 때 사용
			- 예를 들어, 모든 RDS 데이터베이스의 스냅샷을 생성할 수 있음
		- 따라서 콘솔, SDK 및 CLI, Amazon EventBridge, 유지 관리 기간 또는 AWS config를 사용하여 트리거될 수 있습니다 따라서 통합할 수 있음
			- 예를 들어 config에서 리소스가 준수되지 않은 것을 알게 된 경우 SSM 자동화를 실행하기 위해 자동으로 수정 조치를 취할 수 있음
			- 비준수 리소스를 수정
### AWS 비용 탐색기
- 비용 탐색기(Cost Explorer)라는 청구 서비스
- AWS 비용 및 시간에 따른 사용량을 시각화하고 이해하며 관리하는 데 사용
- 사용자 정의 보고서를 생성해서 비용과 사용량 데이터를 분석할 수 있음
- 전체적인 데이터를 분석할 수 있음
	- 전체 계정 간 총비용 및 사용량 등
	- 매달, 매시간 혹은 리소스 레벨의 세부 단위도 확인 가능
- 청구서 요금을 낮추기 위한 최적의 절감형 플랜을 선택할 수 있기 때문에 비용 절감 가능
- 향후 12개월까지의 사용량을 예측할 수 있음
	- 이전 사용량을 기반으로 하며 비용 계획에 큰 도움
- 비용 탐색기의 예시는 AWS 서비스의 월별 비용이 있음
	- 인스턴스 유형에 따라 일부는 다른 것보다 더 비쌀 수 있고 따라서 비용을 최적화하며 인스턴스가 올바로 사용되는지 최대한으로 사용 중인지 크기는 적절한지 등의 질문을 하게 됨
- 시간별 리소스 레벨
	- EC2 인스턴스의 리소스 레벨 정보를 얻는데 시간에 따른 비용이 표시
	- 즉 시간별로 확인할 수 있어서 청구서를 분석하고 이해할 수 있음
- 비용 탐색기로 절감형 플랜을 찾을 수도 있음
- 절감형 플랜은 예약 인스턴스의 대안인데 비용 탐색기를 사용하면 사용량에 따라 어떤 절감형 플랜을 선택할 수 있는지 알려줌
- 과거에 지출했던 비용을 기반으로 예측을 할 수 있는데 청구서 비용에 대한 예측에 확신을 가질 수도 있음
### AWS Batch
- Batch는 완전 관리형 배치 처리 서비스로, 어떤 규모의 배치라도 처리할 수 있음
- Batch 서비스를 사용하면 AWS에서 수십만 개의 컴퓨팅 배치 작업을 매우 쉽고 효율적으로 실행할 수 있음
- 배치 작업은 시작과 끝이 있는 작업이고, 연속적이고 끝나지 않는 스트리밍 작업은 항상 실행 중인 작업임
	- 배치 작업은 오전 1시에 시작하여 오전 3시에 종료
- 배치 작업에는 시작 시점이 있어서 Batch 서비스는 동적으로 EC2 인스턴스 또는 스팟 인스턴스를 시작
	- 배치 작업을 로드하기 위해서
- Batch는 배치 대기열을 처리할 수 있도록, 적절한 양의 컴퓨팅 및 메모리를 프로비저닝
- 배치 작업을 배치 대기열에 올리거나 예약하기만 하면, Batch 서비스가 나머지 작업을 수행
	- 도커 이미지와 ECS 서비스에서 실행되는 작업 정의
	- 즉, ECS에서 실행될 수 있는 것이라면 배치에서도 실행될 수 있다는 뜻
- Batch를 사용하여 배치 작업을 실행하면 매우 좋은 이유는 작업에 필요한 EC2 인스턴스 또는 스팟 인스턴스의 적절한 수를 자동으로 조정해주기 때문
	- 비용 최적화와 인프라에 신경쓰지 않아도 됨
- 사용자가 Amazon S3에 넣은 이미지를 배치 방식으로 처리하고 싶다고 가정
	- 이미지가 Amazon S3에 입력되면 배치 작업이 트리거
	- Batch는 자동으로 EC2 인스턴스 또는 스팟 인스턴스로 구성된 ECS 클러스터를 갖게 되며 Batch는 배치 대기열에 있는 배치 작업을 수행할 수 있는 적절한 양의 인스턴스가 있는지 확인
	- 그리고 인스턴스는 작업을 수행할 Docker 이미지를 실행
	- 작업은 처리된 객체를 삽입하는 일이거나 이미지를 다른 Amazon S3 버킷으로 넣는 필터일 수도 있음
- Batch와 Lambda의 차이점은?
	- lambda
		- <u>Lambda에는 15분의 시간 제한이 있음</u> 
		- 프로그래밍 언어 몇 개로만 액세스할 수 있음
		- 작업을 실행하는 임시 디스크 공간이 제한되어 있음
		- 서버리스
	- Batch는
		- Batch는 EC2 인스턴스에 의존하기 때문에 시간 제한이 없음
		- 도커 이미지로 패키징하는 한 런타임의 길이는 상관없음
		- 스토리지는, EC2 인스턴스와 같이 제공되는 스토리지를 사용
			- EBS 볼륨이 될 수도 있고 디스크 공간을 위한 EC2 인스턴스 스토어일 수도 있음
		- Lambda 함수보다 훨씬 더 많을 수 있음
- 마지막으로 Batch는 서버리스 서비스가 아니라 관리형 서비스이지만 만들어지는 실제 EC2 인스턴스에 의존
### Amazon AppFlow
- AppFlow는 SaaS 애플리케이션 및 AWS 사이에 데이터를 전송할 수 있는 완전 관리형 통합 서비스
- 데이터 소스는 Salesforce, SAP, Zendesk, Slack, ServiceNow 등이 있음
- `Salesforce`, Amazon S3, Amazon Redshift 또는 Snowflake나 Salesforce와 같이 AWS가 아닌 것으로도 데이터를 보낼 수 있음
- 일정에 따라, 또는 특정 이벤트에 대한 응답으로, 또는 주문형으로 통합되도록 정의할 수 있음
- AppFlow 내에서 필터링, 유효성 검사와 같은 데이터 변환도 할 수 있음
- 데이터는 공용 인터넷을 통해 암호화되거나, PrivateLink를 사용하여 비공개로 전송할 수 있음
- AppFlow을 사용하면 통합을 만드는 데 시간을 쓰지 않아도 됨
- API를 활용하여 여러분의 계정 내에서 바로 데이터를 사용할 수 있음
- AppFlow 인터페이스에는 Sources가 있음
	- 다양한 소스들이 있는데 **Salesforce** 가 중요
- AppFlow을 사용하면 이 데이터를 다양한 곳으로 보낼 수 있음, Redshift나 S3 등
### AWS 증폭(AWS Amplify)
- 웹 및 모바일 애플리케이션 개발 도구
- Amplify를 사용하면 AWS의 많은 스택을 한 곳에 통합해서 웹 및 모바일 애플리케이션을빌드할 수 있음
- 백엔드를 만든다고 가정
	- Amplify CLI를 사용해서 Amplify 백엔드를 만들 것
	- 이 백엔드는 우리가 아는 많은 AWS 리소스를 내부적으로 사용
	- 데이터 저장을 위해 Amazon S3를 사용하고 신원 증명을 위해 Amazon Cognito를 사용하고요, API에 AppSync를 사용하고 API Gateway도 사용
	- 머신러닝을 위해 SageMaker도 사용
	- 텍스트 감지를 위해 Lex를, 서비스형 함수를 위해 Lambda를, 데이터를 위해 DynamoDB를 사용
	- Amplify 덕분에 한 곳에서 인증
		- 스토리지 REST API나 GraphQL API 등의 API CI/CD, PubSub, Analytics, AI/ML 예측, 모니터링 등을 설정할 수 있음
	- 출처는 모든 곳이 될 수 있음
		- GitHub, AWS CodeCommit, Bitbucket, GitLab 등이 있고 직접 코드를 업로드할 수도 있음
	- 이 모든 백엔드 서비스를 Amplify 안에서 직접 통합
	- Amplify 프런트엔드 라이브러리를 추가해서 여러분의 Amplify 백엔드에 연결
		- 웹이나 모바일 애플리케이션용으로 많은 프런트엔드 라이브러리가 있고, 프레임워크도 아주 많음
	- Amplify 콘솔을 이용해서 Amplify 자체에 배포하거나 Amazon CloudFront에 배포해서 웹 또는 모바일 애플리케이션을 제공
- <u>Amplify는 웹 및 모바일 애플리케이션을 위한 Elastic Beanstalk</u>
- 하나의 장소로 통합해서 개발자가 웹과 모바일 애플리케이션을 만들기 위한 원스톱 쇼핑몰이 됨
