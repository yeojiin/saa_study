### AWS Snow Family 개요
- Snow Family는 아주 안전한 휴대 기기
- 엣지에서 데이터를 수집하고 처리하거나 데이터를 AWS 안팎으로 마이그레이션하는 것
- 데이터 마이그레이션
	- Snowcone, Snowball Edge, Snowmobile 등 세 가지 종류
- 엣지 컴퓨팅에
	- Snowcone, Snowball Edge 이 있음
- AWS Snow Family를 이용해서 데이터 마이그레이션 하는 이유?
	-  네트워크를 통해서 대량의 데이터를 전송하는 데 걸리는 시간이 오래 걸림
	- 비용 절감, 속도 개선 등을 위해 사용됨
	-  Snow Family는 여러분이 데이터 마이그레이션을 할 수 있게 해주는 `오프라인 기기`
- 작동 원리
	- 파일을 Amazon S3에 직접 업로드한다면 클라이언트가 데이터를 Amazon S3에 전송, 하지만 Snow Family를 사용하고 snowball  기기를 사용한다면 오프라인으로 올릴 수 있어 데이터를 받고 로딩하는데 서비스 문제가 없음
	- Snowball 기기를 사용한다면 클라이언트가 Snowball 기기를 요청하고요 우린 우편을 통해 기기를 받음
	- 로컬에서 데이터를 직접 기기에 로딩하고 그 기기를 다시 AWS의 시설로 반송
	- AWS는 그 기기를 받아서 그걸 자체 인프라에 삽입한 다음에 데이터를 Amazon S3 버킷으로 가져오거나 버킷에서 내보냄
	-  네트워크가 아닌 `물리적 경로`를 사용하는 것
- 물리 기기
	- Snowball Edge
		- 거대한 박스
		- 테라바이트나 페타바이트 용량의 데이터를 AWS와 교환하기 위해 사용
		- snowball Edge 안의 인터페이스는 블록 스토리지나 S3 호환 객체 스토리지를 제공함
		- 두 가지 형태
			- 스토리지가 최적화된 형태, 80TB 용량의 하드디스크 용량이 제공 또는 블록 볼륨이나 S3 호환 객체 스토리지로 사용
			-  컴퓨팅이 최적화된 형태, 용량은 42TB 또는 28TB
		 - 활용 사례
			 - 대규모 데이터의 클라우드 마이그레이션, 데이터센터 폐지, 또는 재난 복구
	- Snowcone
		- 아주 작은 휴대 기기고요, 견고하고 안전
		-  데이터의 양이 적은 환경에 사용됨
		- 형태
			- 8TB의 HDD 스토리지가 장착된 Snowcone
			-  빠른 디스크가 필요한 경우엔 14TB의 SSD가 장착된 Snowcone
				- 공간 제약이 있는 환경, 배터리와 케이블은 여러분이 제공 필요
		- 오프라인으로 데이터를 발송하는 방법
		- 이 기기에 데이터를 담은 다음에 인터넷 연결이 가능할 때 그걸 데이터 센터에 연결하는 방법 -> AWS DataSync 서비스를 사용해서 데이터를 다시 AWS에 전송함
	- Snowmobile
		- 트럭임
		- 데이터를 아주 크게 옮길 수 있고, GPS 등이 있음
		- 10PB 이상의 데이터를 옮길 경우에는 Snowball보다 더 좋음
- 데이터 마이그레이션에는 세 가지
	- Snowcone, Snowball Edge, Snowmobile
- Snow Family 기기
	- AWS 콘솔에서 기기 배송을 요청
	- Snowball 클라이언트 또는 AWS OpsHub를 서버에 설치
	- Snowball을 서버에 연결하고 클라이언트 안에서 파일 복사
	- 기기 반송
	-  데이터는 S3 버킷에 로딩최고 수준의 보안 조치에 따라 Snowball에서 데이터를 완전 제거
- Snow Family에는 두 번째 활용 사례: **에지 컴퓨팅**
	- 에지 위치에서 데이터를 생성하는 중에 그 데이터를 처리
	- 에지 위치는?
		- `인터넷이 없거나` 클라우드에서 멀리 떨어져 있는 모든 것 -> 도로에 있는 트럭이나 바다에 있는 배, 지하에 있는 광산 등
		- 에지 컴퓨팅이 필요
		- Snowball Edge 기기나 Snowcone을 주문하고, 에지 위치에 내장한 후에 에지 컴퓨팅을 시작 가능
	- 데이터 전처리, 클라우드로 가지 않고 에지에서 이루어지는 머신러닝, 미디어 스트림의 사전 트랜스코딩 등
	- Snowcone과 Snowcone SSD 두가지 존재
- Snowcone 기기들은 EC2 인스턴스와 람다 함수를 실행할 수 있음
	- 람다 함수를 위해 AWS IoT Greengrass 서비스  활용
- OpsHub
	- 명령줄 인터페이스, 즉 CLI를 사용이 어려워 해당 부분 보완을 위해 나옴
	- 클라우드에서 사용하는게 아니라 사용자의 컴퓨터나 노트북에 설치하는 소프트웨어에 다운로드 해야 함
	- 연결이 이루어지면 그래픽 인터페이스를 사용해서  Snow 기기에 연결하고 설정하고 사용 -> EC2 인스턴스나 DataSync, NFS(네트워크 파일 시스템) 사용 가능 
### Snowball into Glacier
- Snowball을 통해 데이터를 직접 Glacier에 불러올 수는 없음
- Amazon S3를 `수명 주기 정책`을 생성해 Amazon Glacier로 객체를 전환
### FSx
- AWS에서 완전 관리형 서비스로 타사 고성능 파일 시스템을 실행시킴
	- RDS에서 AWS에 MySQL나 Postgres를 실행하는 것과 같은 개념
	- RDS가 FSx로 바뀌었고 파일 시스템을 실행한다는 점이 차이
- **Lustre, `Windows File Server`, NetApp ONTAP, OpenZFS**
- FSx for Windows File Server
	- 완전 관리형 Windows 파일 서버 공유 드라이브
	- Windows를 사용하기 때문에 SMB 프로토콜과 Windows NTFS를 지원
	- Microsoft Active Directory 통합을 지원, 사용자 보안을 추가할 수 있고 ACL로 사용자 할당량을 추가해 액세스를 제어 가능
	- **Linux EC2 인스턴스에도 마운트할 수 있음**
	- 기존에 온프레미스 등에 Windows 파일 서버가 있는 경우 Microsoft 분산 파일 시스템인 DFS 기능을 이용해서 파일 시스템을 그룹화할 수 있음 -> 온프레미스의 Windows 파일 서버와 FSx for Windows File Server를 결합할 수 있음
	- 스토리지 옵션
		- SSD로 지연 시간이 짧아야 하는 워크로드, 데이터베이스, 미디어 처리 데이터 분석 등
	- 프라이빗 연결로 온프레미스 인프라에서 액세스할 수 있음
	- 고가용성 다중 AZ에 대해 구성 가능
	- 데이터는 재해 복구 목적으로 Amazon S3에 매일 백업
-  FSx for Lustre
	-  분산 파일 시스템으로 대형 연산에 사용되었음, `머신러닝과 HPC` 등 고성능 연산에 사용, 동영상 처리나 금융 모델링 전자 설꼐 자동화 등의 어플리케이션에 사용
	- 확장성이 높음, `IOPS`로 확장됨
	- `Amazon S3와 무결절성 통합이 가능, FSx로 S3를 파일 시스템처럼 읽을 수 있음` 그리고 FSx 연산 출력값을 다시 S3에 쓸 수 있음
	- Lustre, Windows File Server, NetApp ONTAP, OpenZFS
	- VPN과 직접 연결을 통해 온프레미스 서버에서 사용할 수 있음
	- FSx for Lustre는 단일 AZ에만 존재
	- 배포 옵션
		- 스크래치 파일 시스템
			- 스크래치 파일 시스템은 임시 스토리지로 **데이터가 복제되지 않음**
			-  최적화로 초과 버스트를 사용 가능
			- 데이터 저장소에 추가로 S3 버킷을 둘 수도 있음
			- `단기 처리 데이터에 쓰임`
			- 복제가 없어 비용 최적화
			- 데이터 저장소에 추가로 S3 버킷을 둘 수 있음
		- 영구 파일 시스템은 장기 스토리지로 동일한 가용 영역에 데이터가 복제됨
			- 데이터 사본이 두개 생김
			- 첫번째 데이터 볼륨에 복제본이 하나 두 번째 데이터 볼륨에 하나 생김
-  FSx for NetApp ONTAP
	- AWS의 관리형 NetApp ONTAP 파일 시스템
	- `NFS, SMB, iSCSI` 프로토콜과 호환
	- 온프레미스 시스템의 ONTAP이나 NAS에서 실행 중인 워크로드를 AWS로 옮길 수 있음
	- 다양한 운영 체제에서 사용 가능 - Linux, Windows, MacOS AWS의 VMware Cloud, Workspaces, Appstream, EC2, ECS, EKS 등
	- 오토스케일링 가능
	- 복제와 스냅샷 가능
	- `데이터 중복 기능 가능`
	- 시간 복제 기능
		- `파일 시스템에서 신속히 복제가 가능하고, 스테이징 파일 시스템을 둘 수 있음`
		- 새 워크로드 등을 테스트할 때 용이
- Amazon FSx for OpenZFS
	- AWS의 관리형 OpenZFS 파일 시스템
	- 여러 버전에서의 NFS 프로토콜과 호환이 가능
	- `ZFS`에서 실행되는 워크로드를 내부적으로 AWS로 옮길 때 사용
	- Linux, Mac, Windows에서 사용 가능
	- 스냅샷, 압축을 지원하고 비용이 적지만 데이터 중복제거 기능이 없음
	- 시간 동시 복제 기능이 있어 새 워크로드 테스트 시에도 유용
### 스토리지 게이트웨이
- 하이브리드 클라우드를 권장 ->  일부 인프라는 AWS 클라우드에, 나머지는 그대로 온프레미스에 두는 방식
- 클라우드 마이그레이션이 오래 걸리거나 보안 또는 규정 준수 요건이 있는 경우 용이
- S3 데이터(데이터 클라우드)를 온프레미스에 두고 싶을 때? -> AWS Storage Gateway가 S3와 온프레미스 인프라를 이어주는 역할
- AWS의 스토리지 클라우드 네이티브 옵션
	- Amazon EBS나 EC2 인스턴스 같은 블록 스토리지가 존재
	- Amazon EFS나 Amazon FSx 같은 파일 시스템 존재
	- Amazon S3나 Amazon Glacier 같은 객체 수준 스토리지 존재
- AWS Storage Gateway
	- 온프레미스 데이터와 클라우드 데이터를 이어주는  역할
- AWS Storage Gateway를 이용해서 온프레미스 데이터를 클라우드로 이동
-  활용 방법
	- 온프레미스 데이터를 클라우드에 백업 - 재해 복구 목적, 백업, 클라우드 마이그레이션, 온프레미스에서 클라우드 간 스토리지 확장 등에서 사용
	- 데이터 중 대부분을 AWS에 저장하고 파일 액세스 지연 시간을 줄이기 위해 Storage Gateway를 온프레미스 캐시로 사용하는 방법도 있음
- 종류
	- S3 파일 게이트웨이
		- S3 버킷에는 원하는 스토리지 클래스를 임의로 사용
		- Glacier는 안 됨
		- S3 버킷을 온프레미스 상의 애플리케이션 서버에 연결 시 `표준 네트워크 파일 시스템`을 활용
		- S3 파일 게이트웨이를 이용 해 애플리케이션 서버가 `NFS나 SMB` 프로토콜을 사용
		- S3 파일 게이트웨이로 구성한 모든 버킷은 NFS 및 SMB 프로토콜을 이용해서 액세스 가능하고 캐시로 저장됨
		- 아카이브하고 싶을 경우 S3 버킷에 수명 주기 정책을 생성 해 이후 S3 Glacier로 객체를 옮겨 아카이브 되도록 함 
		- 신속한 액세스를 위해 파일 게이트웨이에  캐시로 저장할 수 있음 -> S3 버킷 전체가 아닌 최근에 사용한 파일만 파일 게이트웨이에 잇음
		- 각 파일 게이트웨이마다 IAM 역할을 생성 필요
	- FSx 파일 게이트웨이
		- Amazon FSx for Windows File Server에 네이티브 엑세스 제공
		- FSx for Windows File Server가 Amazon FSx 파일 시스템에 배포되어 있고 회사 데이터 센터에 있는 SMB 클라이언트에 액세스하려 할 때
			- 게이트웨이를 생성하면 자주 액세스하는 데이터의 로컬 캐시를 확보 가능
			- 중요한 파일의 로컬 캐시가 회사 데이터 센터에 쌓이고 엑세스 지연 시간을 단축 시킬 수 있음
	- 볼륨 게이트웨이
		- Amazon S3가 백업하는 iSCSI 프로토콜을 사용
		- 볼륨이 EBS 스냅샷으로 저장되며 온프레미스 볼륨을 복구할 수 있음
		- 유형
			- 캐시 볼륨: 최근 데이터 액세스 시 지연 시간이 낮음
			- 저장 볼륨: 전체 데이터 세트가 온프레미스에 있으며 주기적 Amazon S3 백업
		- 어플리케이션 서버 백업이 필요한 경우 iSCSI 프로토콜로 볼륨 게이트웨이를 생성하고 이 볼륨 게이트웨이가 Amazon S3에 저장되는 Amazon EBS 스냅샷을 생성
	- 테이프 게이트웨이
		- 물리적으로 테이프를 사용하는 백업 시스템이 있는 회사가 백업 테이프 대신 클라우드를 활용해 데이터를 백업
		- 가상 테이프 라이브러리(VTL)는 Amazon S3와 Glacier를 사용
		- 게이트웨이는 회사 데이터 센터에 설치되어 있어야 함
		- 게이트웨이가 없는 경우 AWS 에서 주문해서 설치후 사용 가능
			- 충분한 CPU, 메모리 네트워크, 그리고 SSD 캐시 리소스가 필요
			- 소규모 데이터 센터의 일일 NFS 백업처럼 가상화가 없는 경우 유용
- 요약
	- 온프레미스에서 Storage Gateway VM을 배포하거나 하드웨어 어플라이언스에서 배포 가능
	- 로컬 캐시를 필요로 하는 파일 게이트웨이의 경우
		- NFS나 SMB 프로토콜을 이용하여 액세스 가능
		- 직접 S3 파일 게이트웨이에 연결 해 S3에 백업-> Glacier와 Glacier Deep Archive를 제외한 많은 스토리지 티어
	- FSx 파일 게이트웨이를 사용
		- Amazon FSx for Windows File Server에 데이터를 전송
		- 주기적으로 Amazon S3에 백업
      - 볼륨 게이트웨이를 사용
	      - iSCSI 프로토콜을 통해 애플리케이션 서버를 갖고 볼륨을 마운트
	      - 이렇게 하면 볼륨 게이트웨이는 Storage Gateway를 통해 Amazon S3에 연결되며 해당 위치에 데이터 볼륨이 저장되고 S3에서 해당 데이터가 EBS 볼륨으로 변환되어 AWS에 저장됨
	- 테이프(Tape) 게이트웨이를 이용하면 
		- iSCSI VTL 프로토콜을 통해 백업 애플리케이션에 연결
		- Amazon S3를 테이프 라이브러리로 사용
		- Glacier와 Glacier Deep Archive 티어로 이동시켜서 테이프 아카이브를 생성
### 전송 제품군
- S3 또는 EFS의 안팎으로 데이터를 전송하려고 하는데 FTP 프로토콜만 사용하려는 경우
- FTP의 AWS 전송
	- FTP는 파일 전송 프로토콜, SSL을 통한 파일 전송 프로토콜인 FTPS는 암호화된 형태
	- SFTP가 지원되는데 이건 보안 파일 전송 프로토콜
	- FTP는 암호화되지 않음, FTPS와 SFTP는 전송 중에 암호화
	- FTP를 사용해 S3 또는 EFS에 업로드 가능
- 완전 관리형 인프라이며 확장성, 안정성이 높음, 가용성 높음, 사용자 자격증명을 사용할 수 있음
- FTP의 엔드 포인트를 통해 직접 액세스 하거나 특정 Route 53라는 이름의 DNS를 사용하여 FTP 서비스에 고유의 호스트 이름을 제공할 수 있음
-  FTP 서비스의 전송에는 IAM 역할이 있음
- 외부 인증 시스템으로 사용자를 인증할 수 있음 -> Active Directory와 LDAP 등
### DataSync
- 데이터를 동기화하며 대용량의 데이터를 한 곳에서 다른 곳으로 옮길 수 있음
- 서버를 NFS, SMB HDFS 또는 다른 프로토콜에 연결해야 하고, 연결할 다른 클라우드에 에이전트가 필요
-  AWS 서비스에서 다른 AWS 서비스로 데이터를 옮길 때는 에이전트가 필요 없음
- 데이터는 모든 Amazon S3의 Glacier를 포함, 모든 스토리지 클래스에 동기화 가능
- Amazon EFS로 네트워크 파일 시스템에 저장
- Amazon FSx는 모든 운영체제 사용 가능
- 일정을 지정하여 DataSync 지정 가능
- 파일 권한과 메타데이터 저장 기능
	- 보안과 관련해 **NFS POSIX 파일 시스템 그리고 SMB 권한을 준수**
	- 파일을 한 곳에서 다른 곳으로 옮길 때 위를 이용해 파일의 메타데이터를 보존
- 온프레미스에 NFS 또는 SMB 서버가 있음 ->  온프레미스에 AWS DataSync 에이전트를 설치하고, 이를 NFS 또는 SMB 서버에 연결시켜서 해당 에이전트를 이용해 암호화를 거쳐 DataSync 서비스에 연결
- 동기화는 온프레미스에서 AWS 단방향으로 가능하고, AWS에서 다시 온프레미스로 동기화를 실행해 양방향 동기화가 가능해짐
- DataSync를 이용 시 네트워크 용량이 부족할 때
	- AWS Snowcone 장치 사용
- DataSync 에이전트를 이용하여 다른 클라우드에서 동기화할 때
	- DataSync를 통해 서로 다른 **AWS 스토리지 서비스 간 동기화도 가능**
	-  Amazon S3, Amazon EFS 또는 Amazon FSx를 Amazon S3, Amazon EFS Amazon FSx로 다시 동기화하려는 경우 AWS DataSync 서비스를 사용하여 데이터 복사본을 생성
	- 서로 다른 AWS 스토리지 서비스 간 메타데이터 또한 유지
-  `NFS 또는 SMB` 서버에 연결하려면 DataSync 에이전트를 실행 필요
### 스토리지 옵션 비교
- Amazon S3
	- 객체 스토리지, 대부분의 AWS와 연결 가능
	- 객체를 아카이브할 때는 S3 Glacier 서비스를 사용
	- 한 번에 한 개의 EC2 인스턴스에만 스토리지를 연결할 때는 EBS 볼륨을 사용
		- EBS 볼륨은 IO1과 IO2 볼륨에 다중 연결 기능을 지원
- EBS 볼륨
	- GP3 볼륨, IO2 볼륨 등
	- EC2 Instance 스토리지: IOPS가 높은 EC2 인스턴스에 네트워크 스토리지가 아닌  물리 스토리지를 필요로 하는 경우
	- Amazon EFS 서비스:  인스턴스가 네트워크 파일 시스템을 필요로 하며 다중 가용 영역 간 마운트해야 하면서 POSIX 파일 시스템을 쓸 경우
	- Amazon FSx for Windows Service: Windows 서버 파일 시스템을 필요로 하는 경우
	- FSx for Lustre : 고성능 연산 Linux 파일 시스템이며 Lustre 클라이언트와 호환 가능해야 하는 경우
	- FSx NetApp ONTAP : 높은 운영 체제 호환성과 **네트워크 파일 시스템**이 필요
	- FSx for OpenZFS:  관리형 ZFS 파일 시스템이 필요
- 온프레미스와 AWS 간 스토리지를 연결하는 방법
	- Storage Gateway: S3와 FSx 파일 게이트웨이를 이용하여 온프레미스와 Amazon S3 또는 Amazon FSx에 파일을 동기화 가능
	- 볼륨 게이트웨이:  온프레미스 서버에 볼륨을 마운트할 수 있고, 클라우드에 백업도 가능
	- 테이프 게이트웨이: 테이프 형식으로 백업을 실행
	- AWS Transfer Family: Amazon S3나 Amazon EFS 외에도 FTP, FTPS SFTP 인터페이스를 필요로 하는 경우
		- 데이터 일부를 공개하는데 S3 버킷은 private으로 유지하고 일부 데이터 셋을 공개하고, FTP 프로토콜로 접근할 수 있도록 할 경우
- DataSync: 온프레미스에서 AWS, 그리고 AWS에서 AWS로 **일정에 따라** 데이터를 동기화할 때 사용
- Snowcone, Snowball, Snowmobile : 데이터를 옮기는 데 쓸 네트워크 용량이 없거나 물리적으로 대용량의 데이터를 옮겨야 할 때
	- Snowcone: DataSync 에이전트가 사전 설치되어 온다는 특징
